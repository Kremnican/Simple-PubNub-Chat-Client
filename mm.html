<!doctype html>
<html>
<head>
	<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
	<meta http-equiv="Cache-Control" content="no-cache" />
	<meta http-equiv="Expires" content="Fri, Jan 01 1970 00:00:00 GMT" />
	<meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">
	<meta name="MobileOptimized" content="width">
	<meta name="HandheldFriendly" content="true">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=2.0, user-scalable=yes">

	<title id="mytitle"></title>
	<script src="http://cdn.pubnub.com/pubnub.min.js"></script>
	<script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
	<script type="text/javascript" src="emoticons/emoticons.js"></script>
	<link rel="stylesheet" type="text/css" href="http://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.1.1/css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="style.css">
	<link rel="stylesheet" type="text/css" href="../emoticons/emoticons.css"/>

	<style id="mystyles"></style>
</head>
<body class="hidden">
	<div class="header">
		<span class="menu-icon" onclick="openNav()">&#9776;</span>
		<input type="checkbox" name="want-smiliesx" id="want-smiliesx" unchecked/>
	</div>

	<div id="mySidenav" class="sidenav">
		<a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
		<h1>Menu</h1>

		<div class="sidenav-content">
			<div class="row">
				<span>Settings</span>
			</div>
			<div class="row">
				<input type="checkbox" id="want-beep"/><label>Beep</label>
			</div>
			<div class="row">
				<input type="checkbox" id="want-notification" disabled/><label>Notification</label>
			</div>
			<div class="row">
				<input type="checkbox" name="want-smilies" id="want-smilies" unchecked/><label>Emoticons</label>
			</div>
			<!--<div class="row">
				<input type="checkbox" name="dhl-color" id="dhl-color"/><label>DHL Header colour</label>
			</div>-->
		</div>
		<div class="sidenav-content">
			<div class="row">
				<span>New connection</span>
			</div>

			<div class="row">
				<input list="newconnection" name="newconnection" id="new-connection" placeholder="Select Room">
				<datalist id="newconnection">
					<option value="Stock">
					<option value="MoveTask">
					<option value="GoodsIn">
					<option value="GoodsOut">
					<option value="Global">
				</datalist>
			</div>

			<div class="row">
				<input type="checkbox" id="new-window"/><label>Open in new window</label>
			</div>
			<div class="row">
				<button onclick="customChannel()" >Connect</button>
			</div>
		</div>
	</div>

	<div class="main">

		<div class="sidebar">
			<div id="userList" class="userList" ></div>
		</div>

		<div class="container">

			<div class="message-box">
				<div id="chatHistory" class="chatHistory smilies-disabled"></div>

				<form class="message-input">
					<input type="text" id="message" class="message" autocomplete="off"/>
					<input type="submit" id="sendButton" class="btn btn-primary sendButton" name="Update" value="Go" style="display:none"/>
				</form>

        		<div class="emo-box">
				  	<div class="emo_picker">
						<span class="emoticon emoticon-smile">:)</span>
						<span class="emoticon emoticon-sad-smile">:(</span>
						<span class="emoticon emoticon-big-smile">:D</span>
						<span class="emoticon emoticon-cool">8)</span>
						<span class="emoticon emoticon-wink">;)</span>
						<span class="emoticon emoticon-surprised">:O</span>
						<span class="emoticon emoticon-crying">;(</span>
						<span class="emoticon emoticon-sweating">(sweat)</span>
						<span class="emoticon emoticon-speechless">:|</span>
						<span class="emoticon emoticon-kiss">:*</span>
						<span class="emoticon emoticon-tongue-out">:P</span>
						<span class="emoticon emoticon-blush">:$</span>
						<span class="emoticon emoticon-wondering">:^)</span>
						<span class="emoticon emoticon-sleepy">|-)</span>
						<span class="emoticon emoticon-dull">|("</span>
						<span class="emoticon emoticon-in-love">(inlove)</span>
						<span class="emoticon emoticon-evil-grin">]:)</span>
						<span class="emoticon emoticon-talking">(talk)</span>
						<span class="emoticon emoticon-yawn">(yawn)</span>
						<span class="emoticon emoticon-puke">(puke)</span>
						<span class="emoticon emoticon-doh">(doh)</span>
						<span class="emoticon emoticon-angry">:@</span>
						<span class="emoticon emoticon-it-wasnt-me">(wasntme)</span>
						<span class="emoticon emoticon-party">(party)</span>
						<span class="emoticon emoticon-worried">:S</span>
						<span class="emoticon emoticon-mmm">(mm)</span>
						<span class="emoticon emoticon-nerd">8-|</span>
						<span class="emoticon emoticon-evil-grin-1">]:)</span>
						<span class="emoticon emoticon-lips-sealed">:x</span>
						<span class="emoticon emoticon-hi">(hi)</span>
						<span class="emoticon emoticon-call">(call)</span>
						<span class="emoticon emoticon-devil">(devil)</span>
						<span class="emoticon emoticon-angel">(angel)</span>
						<span class="emoticon emoticon-envy">(envy)</span>
						<span class="emoticon emoticon-wait">(wait)</span>
						<span class="emoticon emoticon-bear">(bear)</span>
						<span class="emoticon emoticon-make-up">(makeup)</span>
						<span class="emoticon emoticon-giggle">(giggle)</span>
						<span class="emoticon emoticon-clapping">(clap)</span>
						<span class="emoticon emoticon-thinking">(think)</span>
						<span class="emoticon emoticon-bow">(bow)</span>
						<span class="emoticon emoticon-rofl">(rofl)</span>
						<span class="emoticon emoticon-whew">(whew)</span>
						<span class="emoticon emoticon-happy">(happy)</span>
						<span class="emoticon emoticon-smirk">(smirk)</span>
						<span class="emoticon emoticon-nod">(nod)</span>
						<span class="emoticon emoticon-shake">(shake)</span>
						<span class="emoticon emoticon-punch">(punch)</span>
						<span class="emoticon emoticon-emo">(emo)</span>
						<span class="emoticon emoticon-yes">(y)</span>
						<span class="emoticon emoticon-no">(n)</span>
						<span class="emoticon emoticon-handshake">(handshake)</span>
						<span class="emoticon emoticon-heart">(h)</span>
						<span class="emoticon emoticon-broken-heart">(u)</span>
						<span class="emoticon emoticon-mail">(e)</span>
						<span class="emoticon emoticon-flower">(f)</span>
						<span class="emoticon emoticon-rain">(rain)</span>
						<span class="emoticon emoticon-sun">(sun)</span>
						<span class="emoticon emoticon-time">(o)</span>
						<span class="emoticon emoticon-music">(music)</span>
						<span class="emoticon emoticon-movie">(~)</span>
						<span class="emoticon emoticon-phone">(mp)</span>
						<span class="emoticon emoticon-coffee">(coffee)</span>
						<span class="emoticon emoticon-pizza">(pi)</span>
						<span class="emoticon emoticon-cash">(cash)</span>
						<span class="emoticon emoticon-muscle">(muscle)</span>
						<span class="emoticon emoticon-cake">(cake)</span>
						<span class="emoticon emoticon-beer">(beer)</span>
						<span class="emoticon emoticon-drink">(d)</span>
						<span class="emoticon emoticon-dance">(dance)</span>
						<span class="emoticon emoticon-ninja">(ninja)</span>
						<span class="emoticon emoticon-star">(*)</span>
						<span class="emoticon emoticon-mooning">(mooning)</span>
						<span class="emoticon emoticon-finger">(finger)</span>
						<span class="emoticon emoticon-bandit">(bandit)</span>
						<span class="emoticon emoticon-drunk">(drunk)</span>
						<span class="emoticon emoticon-smoking">(smoking)</span>
						<span class="emoticon emoticon-toivo">(toivo)</span>
						<span class="emoticon emoticon-rock">(rock)</span>
						<span class="emoticon emoticon-headbang">(headbang)</span>
						<span class="emoticon emoticon-bug">(bug)</span>
						<span class="emoticon emoticon-fubar">(fubar)</span>
						<span class="emoticon emoticon-poolparty">(poolparty)</span>
						<span class="emoticon emoticon-swear">(swear)</span>
						<span class="emoticon emoticon-tmi">(tmi)</span>
						<span class="emoticon emoticon-heidy">(heidy)</span>
						<span class="emoticon emoticon-malthe">(malthe)</span>
						<span class="emoticon emoticon-tauri">(tauri)</span>
						<span class="emoticon emoticon-priidu">(priidu)</span>
				  	</div>
				  	<div id="emo-icon" class="X">-</div>
				</div>
        	</div>
		</div>
	</div>

	<script type="text/javascript">



		(function() {

			//nahodne pozadie
			/*var images = ['Images/dhl-bg.jpg','Images/wolf.jpg','Images/chat.jpg','Images/clif.jpg','Images/colors.jpg','Images/girl.jpg','Images/jerry.jpg','Images/mountin.jpg','Images/road.jpg','Images/sky.jpg','Images/wolf2.jpg',];
			document.getElementsByClassName('main')[0].style.backgroundImage = 'url(' + images[Math.round(Math.random() * images.length)] + ')';*/


			//ziskaj username a room pass, odstran medzery a sprav uppercase
			myusername = window.location.search.substring(1).split(',')[0];
			str = myusername.replace(/%20/g, "");
			replaced = str.toLowerCase().replace(/\b[a-z]/g, function(letter) {return letter.toUpperCase();});
			var mychannel = window.location.search.substring(1).split(',')[1];
			//alert(usernamee);

			//Moje kluce
			var publish_key = 'pub-c-7170cfb0-336d-4938-9ba9-5ac184687a93';
			var subscribe_key = 'sub-c-65c8a18e-1a25-11e8-a62b-2601d0c1a2aa';

			channel = mychannel;
			var username = replaced;

			//aktualny cas
			var time = new Date().toLocaleTimeString('en-GB', { hour: "numeric", minute: "numeric"});

			//Aktualizuj title podla kanala
			$('#mytitle')[0].innerHTML = $('#mytitle')[0].innerHTML + 'Outlook - ' + mychannel;

			//Aktualizuj styles
			/*$('#mystyles')[0].innerHTML = '.' + username + ' .user-message{background:#f8bd77;text-align: right;color:#000} .' + username + ' .user-name{float:right} .' + username + ' .user-time{float:left}';*/

			pubnub = PUBNUB.init({
				publish_key : publish_key,
				subscribe_key : subscribe_key,
				mytime : time,
				uuid : username,

			});

			pubnub.history({
				channel  : channel,
				count    : 10,

				callback : function(message) {
						content = message.toString().replace( /,/ig, '' );
						mycontent = content.substring(0, content.length - 34);
						$('#chatHistory')[0].innerHTML = mycontent + $('#chatHistory')[0].innerHTML;
						scrollToBottom();
				}
			});

			pubnub.subscribe({
				channel : channel,
				callback : function(message) {
					$('#chatHistory')[0].innerHTML = $('#chatHistory')[0].innerHTML + message;
					scrollToBottom();

					//Ak nie je okno aktivne zrob notifikaciu a beep, vzhladom na checkbox
					if (!document.hasFocus()) {
						var beepit = document.getElementById('want-beep');
						if (beepit.checked) {
							beep();
						}
						var notifyme = document.getElementById('want-notification');

						if (notifyme.checked) {
							var linkb = 'nm.html?';
							wheight=600;
							wwidth=330;
							tt=window.innerHeight-wheight;
							ll=window.innerWidth-wwidth;
							notification = window.open(linkb,'newMessage','width=250,height=40,top='+ tt +',left=' + ll);
							notification.focus();
						}
					}
				},
				presence : function(state) {
					if (state.action == 'join') {
						if ($('#userList').text().indexOf(state.uuid) == -1) {
							$('#userList')[0].innerHTML = state.uuid + '<br/><br/>' + $('#userList')[0].innerHTML;
						}
					} else if (state.action == 'leave' || state.action == 'timeout') {
						var index = $('#userList')[0].innerHTML.indexOf(state.uuid);
						if ( index !== -1) {
							$('#userList')[0].innerHTML = $('#userList')[0].innerHTML.substring(0,index) +
							$('#userList')[0].innerHTML.substring(index+state.uuid.length+8);
						}
					}
				}
			});

			function beep() {
				var snd = new Audio("data:audio/wav;base64,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qJrx4KOQjahZxWbcZgztj2c49nKmkId44S71j0c8eV9yDK6uPRzx5X18eDvjvQ6yKo9ZSS6l//8elePK/Lf//IInrOF/FvDoADYAGBMGb7FtErm5MXMlmPAJQVgWta7Zx2go+8xJ0UiCb8LHHdftWyLJE0QIAIsI+UbXu67dZMjmgDGCGl1H+vpF4NSDckSIkk7Vd+sxEhBQMRU8j/12UIRhzSaUdQ+rQU5kGeFxm+hb1oh6pWWmv3uvmReDl0UnvtapVaIzo1jZbf/pD6ElLqSX+rUmOQNpJFa/r+sa4e/pBlAABoAAAAA3CUgShLdGIxsY7AUABPRrgCABdDuQ5GC7DqPQCgbbJUAoRSUj+NIEig0YfyWUho1VBBBA//uQZB4ABZx5zfMakeAAAAmwAAAAF5F3P0w9GtAAACfAAAAAwLhMDmAYWMgVEG1U0FIGCBgXBXAtfMH10000EEEEEECUBYln03TTTdNBDZopopYvrTTdNa325mImNg3TTPV9q3pmY0xoO6bv3r00y+IDGid/9aaaZTGMuj9mpu9Mpio1dXrr5HERTZSmqU36A3CumzN/9Robv/Xx4v9ijkSRSNLQhAWumap82WRSBUqXStV/YcS+XVLnSS+WLDroqArFkMEsAS+eWmrUzrO0oEmE40RlMZ5+ODIkAyKAGUwZ3mVKmcamcJnMW26MRPgUw6j+LkhyHGVGYjSUUKNpuJUQoOIAyDvEyG8S5yfK6dhZc0Tx1KI/gviKL6qvvFs1+bWtaz58uUNnryq6kt5RzOCkPWlVqVX2a/EEBUdU1KrXLf40GoiiFXK///qpoiDXrOgqDR38JB0bw7SoL+ZB9o1RCkQjQ2CBYZKd/+VJxZRRZlqSkKiws0WFxUyCwsKiMy7hUVFhIaCrNQsKkTIsLivwKKigsj8XYlwt/WKi2N4d//uQRCSAAjURNIHpMZBGYiaQPSYyAAABLAAAAAAAACWAAAAApUF/Mg+0aohSIRobBAsMlO//Kk4soosy1JSFRYWaLC4qZBYWFRGZdwqKiwkNBVmoWFSJkWFxX4FFRQWR+LsS4W/rFRb/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////VEFHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAU291bmRib3kuZGUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMjAwNGh0dHA6Ly93d3cuc291bmRib3kuZGUAAAAAAAAAACU=");
				snd.play();
			}

			function bottom() {
				var objDiv = document.getElementById("chatHistory");
				objDiv.scrollTop = objDiv.scrollHeight;
			};

			const scrollToBottom = () => {
				$('#chatHistory').scrollTop($('#chatHistory')[0].scrollHeight);
			};

			pubnub.bind('click', pubnub.$('sendButton'), function(e) {
				var text = $('#message').val()
				if(text == ""){ //Validation
					alert("Can't send empty message.");
				} else {

					var definition = {smile:{title:"Smile",codes:[":)",":=)",":-)"]},"sad-smile":{title:"Sad Smile",codes:[":(",":=(",":-("]},"big-smile":{title:"Big Smile",codes:[":D",":=D",":-D",":d",":=d",":-d"]},cool:{title:"Cool",codes:["8)","8=)","8-)","B)","B=)","B-)","(cool)"]},wink:{title:"Wink",codes:[";)",";-)",";=)"]},surprised:{title:"Surprised",codes:[":O",":o"]},crying:{title:"Crying",codes:[";(",";-(",";=("]},sweating:{title:"Sweating",codes:["(sweat)","(:|"]},speechless:{title:"Speechless",codes:[":|",":=|",":-|"]},kiss:{title:"Kiss",codes:[":*",":=*",":-*"]},"tongue-out":{title:"Tongue Out",codes:[":P",":=P",":-P",":p",":=p",":-p"]},blush:{title:"Blush",codes:["(blush)",":$",":-$",":=$",':">']},wondering:{title:"Wondering",codes:[":^)"]},sleepy:{title:"Sleepy",codes:["|-)","I-)","I=)","(snooze)"]},dull:{title:"Dull",codes:["|(","|-(","|=("]},"in-love":{title:"In love",codes:["(inlove)"]},"evil-grin":{title:"Evil grin",codes:["]:)",">:)","(grin)"]},talking:{title:"Talking",codes:["(talk)"]},yawn:{title:"Yawn",codes:["(yawn)","|-()"]},puke:{title:"Puke",codes:["(puke)",":&",":-&",":=&"]},"doh!":{title:"Doh!",codes:["(doh)"]},angry:{title:"Angry",codes:[":@",":-@",":=@","x(","x-(","x=(","X(","X-(","X=("]},"it-wasnt-me":{title:"It wasn't me",codes:["(wasntme)"]},party:{title:"Party!!!",codes:["(party)"]},worried:{title:"Worried",codes:[":S",":-S",":=S",":s",":-s",":=s"]},mmm:{title:"Mmm...",codes:["(mm)"]},nerd:{title:"Nerd",codes:["8-|","B-|","8|","B|","8=|","B=|","(nerd)"]},"lips-sealed":{title:"Lips Sealed",codes:[":x",":-x",":X",":-X",":#",":-#",":=x",":=X",":=#"]},hi:{title:"Hi",codes:["(hi)"]},call:{title:"Call",codes:["(call)"]},devil:{title:"Devil",codes:["(devil)"]},angel:{title:"Angel",codes:["(angel)"]},envy:{title:"Envy",codes:["(envy)"]},wait:{title:"Wait",codes:["(wait)"]},bear:{title:"Bear",codes:["(bear)","(hug)"]},"make-up":{title:"Make-up",codes:["(makeup)","(kate)"]},"giggle":{title:"Covered Laugh",codes:["(giggle)","(chuckle)"]},"clapping-hands":{title:"Clapping Hands",codes:["(clap)"]},thinking:{title:"Thinking",codes:["(think)",":?",":-?",":=?"]},bow:{title:"Bow",codes:["(bow)"]},rofl:{title:"Rolling on the floor laughing",codes:["(rofl)"]},whew:{title:"Whew",codes:["(whew)"]},happy:{title:"Happy",codes:["(happy)"]},smirking:{title:"Smirking",codes:["(smirk)"]},nodding:{title:"Nodding",codes:["(nod)"]},shaking:{title:"Shaking",codes:["(shake)"]},punch:{title:"Punch",codes:["(punch)"]},emo:{title:"Emo",codes:["(emo)"]},yes:{title:"Yes",codes:["(y)","(Y)","(ok)"]},no:{title:"No",codes:["(n)","(N)"]},handshake:{title:"Shaking Hands",codes:["(handshake)"]},skype:{title:"Skype",codes:["(skype)","(ss)"]},heart:{title:"Heart",codes:["(h)","<3","(H)","(l)","(L)"]},"broken-heart":{title:"Broken heart",codes:["(u)","(U)"]},mail:{title:"Mail",codes:["(e)","(m)"]},flower:{title:"Flower",codes:["(f)","(F)"]},rain:{title:"Rain",codes:["(rain)","(london)","(st)"]},sun:{title:"Sun",codes:["(sun)"]},time:{title:"Time",codes:["(o)","(O)","(time)"]},music:{title:"Music",codes:["(music)"]},movie:{title:"Movie",codes:["(~)","(film)","(movie)"]},phone:{title:"Phone",codes:["(mp)","(ph)"]},coffee:{title:"Coffee",codes:["(coffee)"]},pizza:{title:"Pizza",codes:["(pizza)","(pi)"]},cash:{title:"Cash",codes:["(cash)","(mo)","($)"]},muscle:{title:"Muscle",codes:["(muscle)","(flex)"]},cake:{title:"Cake",codes:["(^)","(cake)"]},beer:{title:"Beer",codes:["(beer)"]},drink:{title:"Drink",codes:["(d)","(D)"]},dance:{title:"Dance",codes:["(dance)","\\o/","\\:D/","\\:d/"]},ninja:{title:"Ninja",codes:["(ninja)"]},star:{title:"Star",codes:["(*)"]},mooning:{title:"Mooning",codes:["(mooning)"]},finger:{title:"Finger",codes:["(finger)"]},bandit:{title:"Bandit",codes:["(bandit)"]},drunk:{title:"Drunk",codes:["(drunk)"]},smoking:{title:"Smoking",codes:["(smoking)","(smoke)","(ci)"]},toivo:{title:"Toivo",codes:["(toivo)"]},rock:{title:"Rock",codes:["(rock)"]},headbang:{title:"Headbang",codes:["(headbang)","(banghead)"]},bug:{title:"Bug",codes:["(bug)"]},fubar:{title:"Fubar",codes:["(fubar)"]},poolparty:{title:"Poolparty",codes:["(poolparty)"]},swearing:{title:"Swearing",codes:["(swear)"]},tmi:{title:"TMI",codes:["(tmi)"]},heidy:{title:"Heidy",codes:["(heidy)"]},myspace:{title:"MySpace",codes:["(MySpace)"]},malthe:{title:"Malthe",codes:["(malthe)"]},tauri:{title:"Tauri",codes:["(tauri)"]},priidu:{title:"Priidu",codes:["(priidu)"]}};
					$.emoticons.define(definition);

					var textWithEmoticons = $.emoticons.replace(text); // Replace your plain text with emoticons.
					var etime = new Date().toLocaleTimeString('en-GB', { hour: "numeric", minute: "numeric"});

					pubnub.publish({
						channel : channel,
						message : '<div class="post ' + pubnub.get_uuid() + ' "><span class="user-name">' + pubnub.get_uuid() + '</span><span class="user-time">' + etime + '</span><div class="user-message">' + textWithEmoticons + '</div></div>'
					});
					$('#message').val('');
				}
			});
		})();

		function customChannel() {
			var username = window.location.search.substring(1).split(',')[0];
			var partner = $('#new-connection').val();
			var newindow = document.getElementById('new-window');
			var connlink = 'pm.html?' + username + ',' + partner;

			if (!newindow.checked) {
				window.location = 'pm.html?' + username + ',' + partner;
			} else {
				var winname = Math.floor(1000 + Math.random() * 9000);
				window.open(connlink, winname,'width=300,height=405');
			}
		}

	</script>
	<script type="text/javascript">
		function leave() {
			pubnub.unsubscribe({
				channel : channel,
				callback : function() {
					window.location = 'Login.html';
				}
			});
		}
	</script>
	<script>
		function openNav() {document.getElementById("mySidenav").style.marginLeft = "0";}
		function closeNav() {document.getElementById("mySidenav").style.marginLeft = "-300px";}

		$('input[name=want-smilies]').change(function() {
			var smilies = document.getElementById('want-smilies');
			if (smilies.checked) {
				$('#chatHistory').addClass('smilies-enabled');
				$('#chatHistory').removeClass('smilies-disabled');
			} else if (!smilies.checked) {
				$('#chatHistory').addClass('smilies-disabled');
				$('#chatHistory').removeClass('smilies-enabled');
			}
		});

		$('input[name=want-smiliesx]').change(function() {
			var smiliesx = document.getElementById('want-smiliesx');
			if (smiliesx.checked) {
				$('#chatHistory').addClass('smilies-enabled');
				$('#chatHistory').removeClass('smilies-disabled');
			} else if (!smiliesx.checked) {
				$('#chatHistory').addClass('smilies-disabled');
				$('#chatHistory').removeClass('smilies-enabled');
			}
		});

	</script>
	<script type="text/javascript">
    $(function() {
        $('.emo_picker span').click(function() {
            var value = $(this).text();
            var input = $('#message');
            input.val(input.val() + " " + value + " " );
             $('#message').focus();
            return false;
        });
    });
	</script>

</body>
</html>
